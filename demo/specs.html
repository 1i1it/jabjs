<!DOCTYPE html>
<html>
<head>
<title>JabJS - Super-Simple Data-Binding</title>
<script text="text/javascript" src="../jab.js"></script>
<style>
.pass { border: 3px solid green; padding: 5px;}
/*.res { border: 3px solid red; padding: 5px;}*/
.box { border: 1px dotted blue; padding: 5px;}
</style>
</head>

<body>
<h1>JabJS - Super-Simple Data-Binding - A Walk-Through</h1>
<script>
// bind property to element - DONE
// bind property to element, two way - DONE
// bind property to element, three way, using an array of elements - DONE
// bind property to element, select & checkbox - DONE
// bind property to selector - DONE

// bind with special binding (show, bgcolor, clickhandler) - DONE
// bind with custom bindings - DONE

// bind sub-element  - DONE
// afterhooks, interactive menus - DONE
// binding to javascript variables - DONE

// bind object to DOM node, recursively (with 'name' to signify obj's keys) - DONE
// bind object to DOM node, recursively (with custom domAttr to signify obj's keys) - DONE

// bind array of objects to element (repeater *within container - you must have container*) - DONE
// bind array to repeater (with custom dom attr to signify obj's keys)
// bind array as nested field, update in place
// bind array as nested field, replace completely 
// bind array - set new item using "set" 

// bind object, including array as nested field

//todos mvc
function get(selector) { return document.querySelector(selector) || document.getElementById(selector)  }

function passElem(elem) { elem.classList.remove('res'); elem.classList.add('pass'); }
function assertElem(selector, expectedValue) { 
    var elem = get(selector);
    var pass = ( (elem.value == expectedValue) || (elem.textContent == expectedValue) );
    if (pass) passElem(elem);        
}

function assertModel(variable, expectedValue, selectorForStatus) { 
    var elem = get(selectorForStatus);
    var msg =  "model is: "+variable+" and should have been "+expectedValue;
    elem.textContent = elem.value = msg;    
    if (variable == expectedValue) passElem(get(selectorForStatus)); 
}

function simulateChanged(elem) { 
    elem.dispatchEvent(new Event('keyup'));
    elem.dispatchEvent(new Event('change'));
}

function setVal(selector, val) {
    var elem = get(selector);    
    elem.value = val;
    simulateChanged(elem);
}
</script>

<ol>
    <li>
        <h4> Bind Property To Element </h4>            
        <span class="box" id="adam"></span> <span>(view should show "adam2")</span>
        
         <script class="script">
            adam = {name: 'adam'}; 
            jab.bind(adam, 'name', '#adam');
            adam.name = "adam2";
            
            //assertElem('adam', 'adam2');
        </script>                    
    </li>

    <li>
        <h4> Bind Property To Element, Two Way </h4>            
        <input class="res" id="bob">
        <!--  <span class="res" id="bobModel"></span>  -->
        <span> view & model should show "bob2" (synced)</span>
         <script class="script">
            bob = {name: 'bob'}; 
            jab.bind(bob, 'name', '#bob');            
            setVal("#bob", 'bob2');
            
            //assertElem('#bob', 'bob2');
            //assertModel(bob.name, 'bob2', '#bobModel');
        </script>                    
    </li>
    
    <li>
        <h4> Bind Property To Element, Three Way </h4>            
        <input class="res" id="carol2">
        <textarea class="res" id="carol3"></textarea>
         <!-- <span class="res" id="carolModel"></span>  -->
         <span> View &  two models should show carol3 (synced) </span>
         <script class="script">
            carol = {name: 'carol'};
            carolElems = [get('carol2'), get('carol3')]; 
            jab.bind(carol, 'name', carolElems);            
            
            setVal('#carol2', 'carol2');
            setVal('#carol3', 'carol3');
            
            //assertElem('#carol2', 'carol3');
            //assertElem('#carol3', 'carol3');
            //assertModel(carol.name, 'carol3', '#carolModel');
        </script>                    
    </li>    

    <li>
        <h4> Bind Property To Select, Checkbox </h4>            
        <select id="danny">
            <option value="danny-opt-1">#select (Danny opt 1)</option>  
            <option value="danny-opt-2">#select (Danny opt 2)</option>
        </select>
        <input type="checkbox" id="danny-checkbox" value="value">
                  
         <script class="script">
            danny = {opt: 1};            
            jab.bind(danny, 'opt', [get("#danny"), get("#danny-checkbox")]);                        
        </script>                    
    </li>    

    <li>
        <h4> Bind Property To Elem using CSS Selector </h4>            
        <div class="evan"></div>
        <div class="evan"></div>
        
         <script class="script">
            evan = {name: 'evan - selected by class'};            
            jab.bind(evan, 'name', ".evan"); //notice selection with CSS class selector
        </script>                    
    </li>    

    <li>
        <h4> Special Bindings (Not 'sync values') </h4>            
        <div id="fatima">Am I visible? Do I respond to clicks?</div>
        
         <script class="script">
            fatima = {shouldShow: 'false', backgroundColor: 'lightgreen', clickHandler: function(){ console.log("no-op") } };            
            jab.bind(fatima, 'shouldShow', "#fatima", 'show');                        
            jab.bind(fatima, 'backgroundColor', "#fatima", 'bgcolor');                        
            jab.bind(fatima, 'clickHandler', "#fatima", {func: 'click'});                        

            fatima.backgroundColor = 'lightblue';
            fatima.shouldShow = true;
            fatima.clickHandler = function(){ alert("hello fatima"); };            
        </script>                    
    </li>

        <li>
            <h4> Custom Bindings </h4>            
            <div id="homer" style='border: 1px solid green;'>Homer</div>
            
             <script class="script">
                 setBorderWidth = function(elem, value) {                
                    elem.style.borderWidth = value+'px';
                };

                borderData = {width: 20};
                jab.bind(borderData, 'width', get('#homer'), {func: setBorderWidth});
                borderData.width = 10;
            </script>                    
        </li>
    
        <li>
            <h4> Binding Sub-Element </h4>            
            <div id="iris"></div>
            
             <script class="script">
                band = {song: {title: 'something else'} };                
                jab.bind(band.song, 'title', '#iris');

                band.song.title = 'iris';
            </script>                    
        </li>

          <li>
            <h4> Afterhooks, interactive menus </h4>            
            <input id="jamie1">
            <textarea id="jamie2"></textarea>
            <span id="jamie3"></span>

             <script class="script">
                car = {speed: "10", time: "3"};
                computeDistance = function(){ car.distance = car.speed * car.time; };
                jab.bind(car, 'speed', '#jamie1', {afterHook: computeDistance} ); //#jamie1.value == 10
                jab.bind(car, 'time', '#jamie2', {afterHook: computeDistance}); //#jamie2.value == 3
                jab.bind(car, 'distance', '#jamie3'); //#jamie3.innerHTML == 30
                //now, changing the speed or time via the input elements or JS models will also update #p and distance.
                car.speed = 20 //#jamie1.value == 20, jamie2.value == 3, #jamie3.value == 60
            </script>                    
        </li>

        <li>
            <h4> Binding to JavaScript variables - Pure Reactive JavaScript </h4>            
            <div id="kevin-man">
            
             <script class="script">
                man = {firstName: 'Bill', lastName: 'Clinton', fullName: ''};
                jab.bindVar(man, ['firstName', 'lastName'], function() { man.fullName = man.firstName + " " +man.lastName } ); //whenever firstName or lastName change, fullName will also change...
                jab.bind(man, 'fullName', '#kevin-man'); //...and so will its binded view. 
                
                man.firstName = "George"
                man.lastName = "Bush"
            </script>                    
        </li>        
            
        <li>
            <h4> Bind full object to DOM node recursively (with 'name' to signify obj's keys) </h4>            
            <div id="lauren">
                <div name="number"></div>
                <span name="word"></span>
                <div>
                    <p name="color"></p>
                    <p name="shape"></p>
                </div>
                <input name="country" id="country-lauren">
            </div>
            
             <script class="script">
                lauren = {number: 10, word: 'hello', color: 'blue', shape: 'circle', country: 'USA'};
                jab.bindObj(lauren, "#lauren");                 

                lauren.number = 150;
                setVal("#country-lauren", "Britain");
            </script>                    
        </li>     

        <li>
            <h4> Bind object to DOM node, recursively (with custom domAttr to signify obj's keys)    </h4>            
            <div id="mike">
                <div our-attr="number"></div>
                <span our-attr="word"></span>
                <div>
                    <p our-attr="color"></p>
                    <p our-attr="shape"></p>
                </div>
                <input our-attr="country" id="country-mike">
            </div>
            
             <script class="script">
                mike = {number: 10, word: 'hello', color: 'blue', shape: 'circle', country: 'USA'};
                jab.bindObj(mike, "#mike", "our-attr");                 
                
                mike.number = 12;
                setVal("#country-mike", "Canada");
            </script>                    
        </li>     
        
        <li>
            <h4> Bind array of objects to repeat element (within container)   </h4>            
            <ul id="nancy">
                <li name="a"></li>                
            <ul>
                        
             <script class="script">
                
            </script>                    
        </li>     
            
</ol>
</body>
<!-- <script text="text/javascript" src="jabArr.js"></script> -->
<script>
    //     user = {name: 'Joe'};
    //     jab.bind(user, 'name', document.getElementById('input'));
    // //    arr = [10,20,30]
    //     //elem = ul;
    //  arr = [{a:1}, {a:2}];
    // li = document.querySelector('.li');
    // bindArr(arr, li);

    // cob = {nestedArr: [{b:2},{b:4}] };
    // jab.bind(cob,'nestedArr','#nestedUL');

    // zob = {nestedZob: [{c:5}, {c:7}], area: "beverly hills"};
    // jab.bindObj(zob,'#zob');
</script>
</html>